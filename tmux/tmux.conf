set -g default-terminal "screen-256color"

# vi4tw
set -g status-keys vi
setw -g mode-keys vi

# do note wait after esc
set -sg escape-time 0

# copy/paste with vyp
unbind [
bind Escape copy-mode
unbind p
bind p paste-buffer
bind-key -t vi-copy 'v' begin-selection
bind-key -t vi-copy 'y' copy-selection

# smart pane switching with awareness of vim splits
bind -n C-h run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-h) || tmux select-pane -L"
bind -n C-j run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-j) || tmux select-pane -D"
bind -n C-k run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-k) || tmux select-pane -U"
bind -n C-l run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-l) || tmux select-pane -R"
# bind -n C-\ run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys 'C-\\') || tmux select-pane -l"

# move around panes with hjkl, as one would in vim after pressing ctrl-w
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'


# aggressive resize of window
set-window-option -g aggressive-resize on

# highlight active window
set-window-option -g window-status-current-bg colour9

# save path on new pane
set-environment -g CHERE_INVOKING 1
bind-key v split-window -h -c "#{pane_current_path}"
bind-key s split-window -v -c "#{pane_current_path}"

set-window-option -g xterm-keys on

#key bindings -- allowing for tmux over ssh
bind -n C-t new-window -a
bind -n M-h  prev
bind -n M-l next
bind -n M-H  swap-window -t -1
bind -n M-L swap-window -t +1

bind -n M-F11 set -qg status-bg colour4 \; \
        set-window-option -g window-status-current-bg colour2
bind -n M-F12 set -qg status-bg colour2 \; \
        set-window-option -g window-status-current-bg colour9 \; \
	set -g status-right "#{pane_current_path}"

bind -n M-k \
	send-keys M-F12 \; \
	set -qg status-bg colour4 \; \
        set-window-option window-status-current-bg colour2 \; \
	unbind -n M-h \; \
	unbind -n M-l \; \
	unbind -n M-H \; \
	unbind -n M-L \; \
	unbind -n C-t \; \
	unbind -n C-h\; \
	unbind -n C-j\; \
	unbind -n C-k\; \
	unbind -n C-l\; \
	set prefix C-q\; \
	unbind-key C-b\; \
	bind-key C-q send-prefix

bind -n M-j \
	send-keys M-F11 \; \
	set -qg status-bg colour2 \; \
        set-window-option window-status-current-bg colour9 \; \
	bind -n M-h  prev \; \
	bind -n M-l next \; \
	bind -n M-H swap-window -t -1 \; \
	bind -n M-L swap-window -t +1 \; \
	bind -n C-t new-window -a -c "#{pane_current_path}" \; \
	bind -n C-h run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-h) || tmux select-pane -L"\; \
	bind -n C-j run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-j) || tmux select-pane -D"\; \
	bind -n C-k run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-k) || tmux select-pane -U"\; \
	bind -n C-l run "(tmux display-message -p '#{pane_current_command}' | grep -iq vim && tmux send-keys C-l) || tmux select-pane -R"\; \
	set prefix C-b\; \
	unbind-key C-q\; \
	bind-key C-b send-prefix

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
